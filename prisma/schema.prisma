generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Usuario {
  usuario_id String @id @default(uuid())

  nome_usuario String
  login        String   @unique
  email        String   @unique
  cpf          String   @unique
  funcao       String
  senha        String
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  @@map("usuarios")
}

model CriancasAdolescentes {
  criancas_adolescentes_id String @id @default(uuid())

  cpf String @unique

  nome                   String
  filiacao_pai           String
  filiacao_mae           String
  idade_nascimento       String
  com_quem_mora          String
  endereco               String
  ponto_referencia       String
  telefone               String
  email                  String @unique
  contato                String
  telefone_contato       String
  registro_civil         String
  sexo                   String
  comunidade_originarios String
  deficiencia            String
  condicao_saude         String
  programas_sociais      String
  ocupacao_atividade     String
  renda_familiar         String
  tipo_imovel            String
  situacao_trabalho      String @default("")

  orgao_responsavel              String  @default("")
  orgao_responsavel_outro        String?
  data_encaminhamento            String  @default("")
  motivacao_encaminhamento       String  @default("")
  motivacao_encaminhamento_outro String?

  descricao_atendimento String @default("")
  relato_espontaneo     String @default("")

  Avaliacao_individual     String?
  Avaliacao_familiar       String?
  Avaliacao_domicilio      String?
  Escuta_especializada     String?
  Organ_cuidado_individual String?
  Organ_cuidado_conjunto   String?
  Organ_cuidado_familia    String?

  agente_violador        String @default("")
  status                 String @default("")
  tipo_acompanhamento    String @default("")
  periodo_acompanhamento String @default("")

  motivo_encerramento       String  @default("")
  motivo_encerramento_outro String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  encaminhamentos Encaminhamentos[]

  @@map("criancas_adolescentes")
}

model Responsavel {
  responsavel_id String @id @default(uuid())

  nome     String
  cpf      String  @unique
  email    String  @unique
  telefone String?
  whatsapp String?
  funcao   String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("responsaveis")
}

model Encaminhamentos {
  encaminhamento_id String @id @default(uuid())

  criancas_adolescentes_id String
  crianca_adolescente      CriancasAdolescentes @relation(fields: [criancas_adolescentes_id], references: [criancas_adolescentes_id])

  tipo_encaminhamento       String
  tipo_encaminhamento_outro String?

  necessario Int @default(0)

  efetuado Int @default(0)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@unique([criancas_adolescentes_id, tipo_encaminhamento])
  @@map("encaminhamentos")
}
